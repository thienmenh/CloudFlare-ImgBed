"use strict";(self["webpackChunkCrax_me"]=self["webpackChunkCrax_me"]||[]).push([[221],{4318:function(){},221:function(t,e,a){a.r(e),a.d(e,{default:function(){return T}});var n=a(6023),i=(a(5331),a(8736),a(213),a(5970),a(7009)),o=(a(8450),a(8785),a(4880)),l=(a(7128),a(1450)),d=a(6768),r=a(4232);const s={class:"container"},h={class:"header-content"},c={class:"header-action"},u={class:"main-container"},m={style:{margin:"8px"}},p=["src"];function f(t,e,a,f,b,g){const k=(0,d.g2)("font-awesome-icon"),w=l.R7,T=o.bZ,y=n.o8,F=i.Zq,v=n.Up;return(0,d.uX)(),(0,d.CE)("div",s,[(0,d.bF)(T,null,{default:(0,d.k6)((()=>[(0,d.Lk)("div",h,[e[0]||(e[0]=(0,d.Lk)("span",{class:"title"},"Quản lý người dùng",-1)),(0,d.Lk)("div",c,[(0,d.bF)(w,{disabled:g.disableTooltip,content:"Quay lại trang quản lý chính",placement:"bottom"},{default:(0,d.k6)((()=>[(0,d.bF)(k,{icon:"home",class:"header-icon",onClick:g.handleGoHome},null,8,["onClick"])])),_:1},8,["disabled"]),(0,d.bF)(w,{disabled:g.disableTooltip,content:"Quay lại trang tải lên",placement:"bottom"},{default:(0,d.k6)((()=>[(0,d.bF)(k,{icon:"upload",class:"header-icon",onClick:g.handleGoUpload},null,8,["onClick"])])),_:1},8,["disabled"]),(0,d.bF)(w,{disabled:g.disableTooltip,content:"Đăng xuất",placement:"bottom"},{default:(0,d.k6)((()=>[(0,d.bF)(k,{icon:"sign-out-alt",class:"header-icon",onClick:g.handleLogout},null,8,["onClick"])])),_:1},8,["disabled"])])])])),_:1}),(0,d.Lk)("div",u,[(0,d.bF)(v,{data:b.dealedData,"default-sort":{prop:"count",order:"descending"},class:"main-table","table-layout":"fixed"},{default:(0,d.k6)((()=>[(0,d.bF)(y,{type:"expand"},{default:(0,d.k6)((t=>[(0,d.Lk)("div",m,[e[1]||(e[1]=(0,d.Lk)("h3",{style:{"text-align":"center"}},"Danh sách tệp đã tải lên",-1)),(0,d.bF)(v,{data:t.row.data,style:{width:"100%"},"default-sort":{prop:"metadata.TimeStamp",order:"descending"},"table-layout":"fixed"},{default:(0,d.k6)((()=>[(0,d.bF)(y,{prop:"metadata.FileName",label:"Tên tệp"}),(0,d.bF)(y,{prop:"name",label:"Xem trước tệp"},{default:(0,d.k6)((({row:t})=>[t.metadata?.FileType?.includes("image")?((0,d.uX)(),(0,d.Wv)(F,{key:0,src:"/file/"+t.name,fit:"cover",lazy:"",style:{width:"100px",height:"100px"}},null,8,["src"])):((0,d.uX)(),(0,d.CE)("video",{key:1,src:"/file/"+t.name,controls:"",style:{width:"100px",height:"100px"}},null,8,p))])),_:1}),(0,d.bF)(y,{formatter:g.formatTimeStamp,label:"Thời gian tải lên",prop:"metadata.TimeStamp",sortable:"","sort-method":g.sortByTimestamp},{default:(0,d.k6)((({row:t})=>[(0,d.eW)((0,r.v_)(g.formatTimeStamp(t.metadata.TimeStamp)),1)])),_:1},8,["formatter","sort-method"])])),_:2},1032,["data"])])])),_:1}),(0,d.bF)(y,{prop:"ip",label:"Địa chỉ IP"}),(0,d.bF)(y,{prop:"count",label:"Số lần tải lên",sortable:""})])),_:1},8,["data"])])])}a(4114),a(7642),a(8004),a(3853),a(5876),a(2475),a(5024),a(1698);var b=a(782),g={name:"CustomerConfig",data(){return{tableData:[],dealedData:[]}},computed:{...(0,b.L8)(["credentials"]),disableTooltip(){return window.innerWidth<768}},methods:{async fetchWithAuth(t,e={}){this.credentials&&(e.headers={...e.headers,Authorization:`Basic ${this.credentials}`},e.credentials="include");const a=await fetch(t,e);if(401===a.status)throw this.$message.error("Lỗi trạng thái xác thực, vui lòng đăng nhập lại"),this.$router.push("/adminLogin"),new Error("Unauthorized");return a},dealByIP(t){let e=[],a=new Set;return t.forEach((t=>{t.metadata?.UploadIP&&a.add(t.metadata.UploadIP)})),a.forEach((a=>{let n=t.filter((t=>t.metadata?.UploadIP===a)),i=n.length;e.push({ip:a,count:i,data:n})})),e},handleGoUpload(){this.$router.push("/")},handleLogout(){this.$store.commit("setCredentials",null),this.$router.push("/adminLogin")},handleGoHome(){this.$router.push("/dashboard")},formatTimeStamp(t){return new Date(t).toLocaleString()},sortByTimestamp(t,e){return new Date(t.metadata.TimeStamp)-new Date(e.metadata.TimeStamp)}},mounted(){this.fetchWithAuth("/api/manage/check",{method:"GET"}).then((t=>t.text())).then((t=>{if("true"==t)return this.showLogoutButton=!0,this.fetchWithAuth("/api/manage/list",{method:"GET"});if("Not using basic auth."==t)return this.fetchWithAuth("/api/manage/list",{method:"GET"});throw new Error("Unauthorized")})).then((t=>t.json())).then((t=>{this.tableData=t,this.dealedData=this.dealByIP(t)})).catch((t=>{"Unauthorized"!==t.message&&this.$message.error("Lỗi khi đồng bộ hóa dữ liệu, vui lòng kiểm tra kết nối mạng")}))}},k=a(1241);const w=(0,k.A)(g,[["render",f],["__scopeId","data-v-5946e812"]]);var T=w},8736:function(t,e,a){a(5331)},7128:function(t,e,a){a(5331),a(4318)},8450:function(t,e,a){a(5331)},9104:function(t,e,a){a(5331)},5970:function(t,e,a){a(5331)},8785:function(t,e,a){a(5331)},213:function(t,e,a){a(5331),a(9104)}}]);
//# sourceMappingURL=221.c5d294d8.js.map